# ADWorkerSecondLine
Работа с АД вторая линия.

Требования:
1. .NET 4.0 не ниже
2. PowerShell 3.0 не ниже

Основные возможности:

1.  Настраиваемый фильтр поиска пользователей. В строке поиска возможно выбрать поля по которым необходимо осуществлять поиск пользователя, при значении поиска «по умолчанию», поиск осуществляется по полям Имя, Фамилия, Логин, Имя в АД. Поиск по всем полям осуществляется по признаку «содержит», т.е. если выбрано поле Имя и введено часть имени то будут отображены все пользователи у которых присутствует эта часть.

2.  История поиска пользователей. Присутствует история выполненных запросов, её можно посмотреть развернув поле поиска, также возможно выбрать предыдущий запрос.

3.  Отображение все заблокированных пользователей в домене. Данную возможность удобно использовать для разблокировки пользователей, отобразив всех заблокированных пользователей, возможно быстро найти нужного пользователя для разблокировки, либо определить что пользователь не заблокирован.

4.  Отображение всех пользователей из указанной OU. Удобно использовать для просмотра всех действующих пользователей отдела или подразделения

5.  Вторичный фильтр поиска. Если при первичном поиске было найдено много записей, можно воспользоваться вторичным фильтром чтоб сократить объем найденной информации. Вторичный фильтр осуществляет фильтрацию найденных элементов в списке по полю «Имя пользователя в АД», в результате в списке будут оставлены только те пользователи чьё имя в АД содержит значение вторичного фильтра.

6.  Отображение процесса поиска. Во время поиска в строке состояния отображается информация о ходе обработки полученных результатов из домена, если результатов слишком много или запрос был ошибочным возможно прервать обработку нажав Esc.

7.  Сортировка найденных пользователей. В случае если было найдено множество записей возможно провести сортировку по одной из 4-х доступных колонок, для удобства просмотра найденных записей.

8.  Редактирование данных пользователя в active direсtory. Возможно осуществлять редактирование информации о пользователе ( поля доступные для редактирования, выбраны по принципу самых часто редактируемых полей сотрудниками второй линии). Для редактирования доступны поля: Имя, Фамилия, Логин, Имя в active direсtory, Отображаемое имя, Организация, Должность, Отдел, Адрес, Город, Телефон внутренний, Телефон мобильный, Срок действия учетной записи.

9.  Перемещение пользователя между OU в active direсtory.

10. Расчет срока истечения пароля пользователя. По каждому пользователю доступна информация о дате и времени истечения пароля.

11. Цветовая индикация. Значение поля «Пароль истекает» подсвечивается красным в случае если срок действия пароля сотрудника меньше текущей даты и времени. Если пользователь отключен или заблокирован значение соответствующего поля подсвечивается красным.

12. Включение/Отключение требования смены пароля пользователя при следующем входе в систему. Удобно использовать для настройки учетных записей новых пользователей, отключаем смену пароля, заходим под учетной записью на настраиваемый компьютер, выполняем настройку профиля пользователя, по завершению включаем смену пароля.

13. Сброс пароля на стандартный. Сброс пароля пользователю на (Стандартный пароль) нажатием одной кнопки.

14. Включение/Отключение пользователя.

15. Разблокировка пользователя.

16. Работа с группами пользователя. Подробная информация о группах в которых состоит пользователь. Доступны фильтры поиска в группах пользователя. Возможность добавления пользователя в группу, в режиме добавления пользователя в новые группы действует быстрый поиск, по средствам которого возможно найти группу указав часть названия группы (к примеру указав в фильтре SDELKI будут отображены все группы содержащие в своём названии данную строку). Редактирование описания группы пользователя. При выделении группы присутствует возможность добавления/удаления пользователей в данную группу, удобно использовать когда необходимо добавить несколько пользователей в одну группу, для этого добавляем пользователю нужную группу, выделяем добавленную группу и переходим на вкладку «Пользователи состоящие в группе», жмем добавить и выбираем всех оставшихся пользователей для добавления. Так же присутствует информация о группах в которых состоит выбранная группа.

17. Отображение информации о компьютерах за которыми работал пользователь.

18. Изменение размещения компьютеров за которыми сидел пользователь.

19. Подсветка красным отключенных пользователей в списке найденных пользователей. Если в списке найденных пользователей присутствует несколько записей, отключенные пользователи будут выделены красным цветом.

20. Настраиваемый фильтр поиска компьютеров.

21. История поиска компьютеров.

22. Отображение всех компьютеров из указанной OU.

23. Вторичный фильтр поиска компьютеров.

24. Сортировка найденных компьютеров.

25. Редактирование данных компьютера в active direсtory. Возможно осуществлять редактирование информации о компьютере ( поля доступные для редактирования, выбраны по принципу самых часто редактируемых полей сотрудниками второй линии). Для редактирования доступны поля: Размещение, Описание.

26. Перемещение компьютера между OU в active direсtory.

27. Перемещение выделенного списка компьютеров между OU в active direсtory.

28. Удаление выделенных компьютеров из active direсtory.

29. Подсветка красным отключенных компьютеров в списке найденных.

30. Включение/Отключение компьютера.

31. Работа с группами компьютера. Подробная информация о группах в которых состоит компьютер. Доступны фильтры поиска в группах пользователя. Возможность добавления компьютера в группу, в режиме добавления компьютера в новые группы действует быстрый поиск, по средствам которого возможно найти группу указав часть названия группы (к примеру указав в фильтре 1С будут отображены все группы содержащие в своём названии данную строку). Редактирование описания группы компьютера. При выделении группы присутствует возможность добавления/удаления компьютеров в данную группу, удобно использовать когда необходимо добавить несколько компьютеров в одну группу, для этого добавляем компьютеру нужную группу, выделяем добавленную группу и переходим на вкладку «Компьютеры состоящие в группе», жмем добавить и выбираем всех оставшиеся компьютеры для добавления. Так же присутствует информация о группах в которых состоит выбранная группа.

32. Получение дополнительной информации по компьютеру. По выделенному компьютеру возможно получить дополнительную информацию: IP адрес, Состояние(В сети/Не в сети), Модель устройства, Дата и время последней загрузки устройства, Залогиненые пользователи на компьютере.

33. Поиск свободного имени в АД. Поиска свободного имени компьютера в АД, поиск осуществляется по принципу добавления к указанному имени цифры из указанного диапазона и поиске получившегося имени в ад, если имя присутствует в домене берётся следующая цифра из диапазона.

34. Транслитерация с русского на английский. На вкладке «Пользователи» добавлена кнопка вызывающая окно транслитерации, в окне указываем  строку на русском и жмём Преобразовать.

35. Настраиваемый фильтр поиска групп. Поиск по умолчанию идёт по 4м полям (Отображаемое имя, Имя в АД, Имя до Win 2000, и внутренний параметр АД cn), благодаря чему искать группы рассылки гораздо проще чем в стандартной консоли АД, поиск можно осуществлять по русскому названию группы рассылки, такому же как в консоли Exchange. Русскому названию группы из консоли в Exchange соответствует поле Отображаемое имя.

36. История поиска групп.

37. Отображение всех групп из указанной OU.

38. Вторичный фильтр поиска групп.

39. Сортировка найденных групп.

40. Редактирование данных группы в active direсtory. Возможно осуществлять редактирование информации о группе. Для редактирования доступны поля: Имя в АД, Отображаемое имя, Имя до Win 2000 (login), Описание.

41. Перемещение группы между OU в active direсtory.

42. Работа с участниками группы. Добавление участников (пользователе, компьютеров), удаление участников.

43. Загрузка списка пользователей. При добавлении пользователей в группу, присутствует возможность загрузить список пользователей предварительно обработав список и подготовив для загрузки. Пример: Необходимо в одну группу добавить множество сотрудников, список сотрудников прилагается в формате Ф.И.О. 1) Распознаём pdf заявки в doc. 2) Копируем список сотрудников текстовый файл и приводим его к виду, каждый сотрудник на новой строке. 3) Копируем получившийся список в excel и при помощи функции Данные -> Текст по столбцам разбиваем Ф.И.О на 3 колонки. 4) Удаляем колонку с отчеством и  меняем местами колонки фамилии и имени. 5) Находим необходимую группу в программе, переходим на вкладку Участники группы, выбираем Добавить пользователей -> Загрузить список. 6) Копируем данные из Excel в открывшееся окно. 7) Нажимаем Транслитерация для преобразования списка пользователей с русского в транслит. 8) Сверху окна выбираем поле по которому будет выполняться проверка пользователей в АД, имени и фамилии сотрудника в транслитерации соответствует поле Имя в АД, жмём Проверить в АД. В процессе проверки будет осуществлён поиск сотрудников в АД, поиск будет выполнен для каждой строки по выбранному полю, если в АД присутствуют несколько записей соответствующих искомой строке то будет показано окно выбора со списком все записей из АД для выбора нужной. По завершению проверки все найденные записи будут преобразованы к виду записей в домене, если для какой либо строки не найдётся ни одной записи в домене, строка останется не изменой. В обрабатываемом списке сотрудник Сейфетдинова Лилия не будет найдена в домене, по причине того что в домене её имя записано как Lilya, а не Liliya. Можно провести повторную проверку, удалив имя и выбрав пункт проверки По умолчанию, в процессе повторной проверки уже преобразованные записи проверятся не будут. 9) После того как все строки преобразованы жмем Загрузить, в процессе загрузки будет выполнена повторная проверка каждой записи. 10) Добавляем загруженный список пользователей в группу.Поддержка плагинов. 

Для загрузки плагинов необходимо в каталоге с исполняемым файлом программы создать папку “ Plugins” и поместить доступные плагины в эту папку. Плагины будут загружены при удачной авторизации в домене.

Плагины:

1. Увольнение сотрудника. Плагин «Увольнение сотрудника» выполняет всю необходимую последовательность действий при увольнении сотрудника, в качестве входных данных указывается пользователь в домене и дата увольнения сотрудника. При нажатии кнопки Уволить будут выполнены следующие операции: установка даты истечения срока действия учетной записи; удаление сотрудника из всех групп начинающихся на MOBILE_ACCESS-; Отключение  ActiveSync и WebApp на серевере Exchange у данного сотрудника.

2. Изменение фамилии сотрудника. Плагин «Изменение фамилии сотрудника» выполняет всю необходимую последовательность действий при смене фамилии, в качестве входных данных указывается пользователь в домене и новая фамилия сотрудника на русском. При нажатии кнопки Изменить будут выполнены следующие операции: Изменение фамилии сотрудника в АД в полях Фамилия, Отображаемое имя, Имя в АД, Логин, проведено переименование УЗ; Изменение псевдонима пользователя на сервер Exchange; Добавление новых электронных адресов пользователю и установка нового основного эл.адреса; Изменение SIP адреса на сервере Lync. При изменении фамилии при помощи плагина может возникнуть ситуация когда возникнут ошибки внесения изменений на сервера Exchange и Lync, эти ошибки связаны со скоростью синхронизации между серверами АД, Exchange и Lync, изменения внесенные на один из серверов АД не успевают распространится на все сервера в результате возникает ошибка поиска пользователя с новой фамилией. При возникновении ошибки необходимо выбрать пользователя с измененной фамилией из домена, а в поле новой фамилии оставить фамилию на которую необходимо изменить и повторить процесс переименования.

3. Установка автоответа и пересылки входящих писем в Exchange. Плагин «Установка автоответа и пересылки» выполняет установку указанного автоответа выбранному сотруднику с возможностью пересылки входящих писем сотрудника на указанный адрес, в качестве входных данных указывается пользователь в домене, интервал времени в течении которого будет выполнятся автоответ (если требуется), текст сообщения автоответа в пределах организации, текст сообщения автоответа за пределы организации, адрес для пересылки входящих писем (если требуется). При нажатии кнопки Установить автоответ будут выполнены следующие операции: Установлен автоответ для выбранного пользователя на указанный период если таковой был выбран; усьановлена пересылка входящих писем сотрудника на указанный адрес, если таковой был выбран.

4. Руссификация папок в Outlook. Плагин русифицирует  имена папок в outlook выбранного пользователя путём установки локали в почтовом ящике пользователя с помощью powershell запроса.\

5. Информация из Exchange. Плагин выбирает информацию по указанному пользователю из Exchange. Выбирается следующая информация: Сотояние ActiveSync, WEBApp, MAPI, POP, IMAP, политики установленные для ActiveSync и WEBApp, сотояние переадресации, список электронных адресов пользователя, список правил настроенных пользователем для фильтрации входящей почты, состояние автоответа, список мобильных устройств пользователя подключенных к Exchange.

6. Создание учетной записи сотрудника. Данный плагин создаёт учетную запись сотрудника в AD, Exchange, Lync. При создании выполняются все необходимые проверки на корректность данных. Имеется гибкая система шаблонов для быстрой загрузки групп создаваемому сотруднику, автоподстановка значений в часто повторяющихся полях, а так же возможность привязки обязательных групп сотрудника в зависимости от города в котором будет он находится.
